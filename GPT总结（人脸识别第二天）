人脸识别 + 设备权限控制 Demo（局域网版）— 项目总结
一、项目目标

本项目旨在验证并构建一个 基于人脸识别的设备访问控制系统，用于 主机 + 多台 demo 机 的局域网场景，实现：

摄像头采集人脸

人脸识别（1:N）

根据人员身份判断是否有权限操作某台 demo 机

权限集中管理、可扩展到多设备

当前阶段以 功能可行性验证（PoC）+ 工程结构正确性 为目标。

二、整体架构设计（当前阶段）
1. 角色划分

主机（Host）

作为“中心节点”

维护人员信息、设备信息、权限规则

使用 SQLite 作为本地数据库

后续可扩展为 Web 管理后台 / 中心服务

Demo 机（Device）

运行人脸识别客户端

摄像头采集人脸

本地做人脸特征提取（embedding）

向主机请求权限判定

根据结果决定是否“解锁操作”

当前阶段 demo 机以“软件级控制（ALLOW / DENY）”模拟设备权限。

三、人脸识别设计
1. 人脸数据的存储方式（当前）

使用 InsightFace（buffalo_l 模型）

人脸图片 → 提取 embedding（512 维特征向量）

embedding + 用户名 存储在：

data/embeddings.npz


当前不直接存照片，而是存特征向量，便于比对与性能优化。

2. 人脸识别流程

摄像头采集画面

模型检测人脸并提取 embedding

与本地 embeddings.npz 中的模板做相似度比对

取相似度最高者作为识别结果（who + score）

低于阈值判定为 Unknown

四、权限系统设计（核心）
1. 权限与识别的分离

项目中明确区分：

识别（Who are you）

授权（Are you allowed）

人脸识别成功 ≠ 自动拥有权限

2. 权限存储方式（当前）

使用 SQLite 本地数据库

数据库文件：

data/auth.db

3. 核心表结构

users：人员列表

devices：设备（demo 机）列表

permissions：人员 → 设备 的 allow / deny

logs（预留）：识别与授权日志

4. 当前权限判定逻辑

demo 机识别出 who

根据 who + device_id 查询 SQLite

返回：

ALLOW：允许操作

DENY：禁止操作

权限配置不再写死在代码中，而是通过数据库维护。

五、注册（Enroll）流程设计
当前注册流程

运行 enroll_if.py

输入用户名（如 zansan、lisi）

摄像头采集多张人脸样本

生成 embedding 并写入 embeddings.npz

同步将用户名写入 SQLite 的 users 表

注册 ≠ 授权
是否允许使用某台 demo 机由 permissions 表决定。
